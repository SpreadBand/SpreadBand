{% extends "bands/base.html" %}

{% load scheduletags %}
{% load i18n %}

{% block band_content %}

( <a href="{% url band:edit band.slug %}">edit</a> )

<h4>{{ band.name }}</h4>
<p>{{ band.biography }}</p>

<h5>Pictures</h5>
{% for picture in band.pictures.all %}
<a href="{{ picture.original_image.url }}"><img src="{{ picture.thumbnail_image.url }}"></a>
{% endfor %}
<br>
( <a href="{% url band:picture-new band.slug %}">Upload new</a> )

<h5>Members</h5>
<p>
  <ul>
    {% for member in band.members.all %}
    <li>{{ member.user.first_name }} {{ member.user.last_name }} 
      ({{ member.user.username }}) as {{ member.roles.all|join:', ' }}</li>
    {% endfor %}

    ( <a href="{% url band:membership-request band.slug %}">Join band</a> )<br>
    ( <a href="{% url band:membership-add band.slug %}">Invite Member</a> )
  </ul>
</p>



<h4>Upcoming events</h4>
<p>
  {% get_or_create_calendar band band.id as calendar %}
  <ul>
    {% for event in calendar.event_set.all %}
    <li>{{ event }}</li>
    {% endfor %}
  </ul>
  ( <a href="{% url event:bargain-new band.slug %}">Add a new event</a> )
</p>

<h4>Bargains</h4>
<p>
  <ul>
    {% for contract in contracts %}
    <li><a href="{% url event:bargain-detail contract.id %}">{{ contract.terms.gigbargain }}</a>
      [<a href="{% url event:bargain-approve-band contract.id band.slug %}">Approve</a>|
      <a href="{% url event:bargain-disapprove-band contract.id band.slug %}">Disapprove</a>|
      <a href="{% url event:bargain-update contract.id %}">Edit</a>]</li>
    {% endfor %}
  </ul>
  ( <a href="{% url event:bargain-new band.slug %}">New bargain</a> )
</p>

<h4>Released Albums</h4>
<p>
  <ul>
    {% for album in band.albums.all %}
    <li><a href="{{ album.get_absolute_url }}">{{ album.name }}</a></li>
    {% endfor %}
  </ul>
  ( <a href="{% url album:create band.slug %}">Add a new album</a> )
</p>
</div>

{% endblock %}
